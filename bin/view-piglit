#!/bin/bash

exec_short_name=`basename "$0"`

usage()
{
    echo "Usage"
    echo "  $exec_short_name <regexps>"
    exit 1
}

(( $# >= 1 )) || usage

set -e
platform checkactive
results_dir=$HOME/piglit-results
summary_dir=$HOME/piglit-summary
rmdir --ignore-fail-on-non-empty $results_dir/*
cd "$PLATFORM_ROOT_DIR/piglit/source"
for arg in "$@"; do
    find $results_dir -maxdepth 1 -type d | sort | grep "$arg"
done | xargs ./piglit-summary-html.py --overwrite "$summary_dir"
gnome-open "$summary_dir/index.html"
